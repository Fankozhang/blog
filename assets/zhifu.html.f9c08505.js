import{_ as p}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as e,c as o,a as n,b as s,e as t,f as c,r as l}from"./app.1778f713.js";const i={},u=n("h1",{id:"支付",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#支付","aria-hidden":"true"},"#"),s(" 支付")],-1),r=n("h2",{id:"微信支付",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#微信支付","aria-hidden":"true"},"#"),s(" 微信支付")],-1),k={href:"https://pay.weixin.qq.com/static/product/product_intro.shtml?name=jsapi",target:"_blank",rel:"noopener noreferrer"},d={href:"https://pay.weixin.qq.com/static/applyment_guide/applyment_index.shtml",target:"_blank",rel:"noopener noreferrer"},m=n("h3",{id:"商户号申请",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#商户号申请","aria-hidden":"true"},"#"),s(" 商户号申请")],-1),v=n("h2",{id:"支付宝支付-沙箱",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#支付宝支付-沙箱","aria-hidden":"true"},"#"),s(" 支付宝支付（沙箱）")],-1),q={href:"https://blog.csdn.net/weixin_43952736/article/details/119784560",target:"_blank",rel:"noopener noreferrer"},g=n("h3",{id:"配置沙箱环境",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#配置沙箱环境","aria-hidden":"true"},"#"),s(" 配置沙箱环境")],-1),b={href:"https://opendocs.alipay.com/common/02kkv7?pathHash=9a45a6d6",target:"_blank",rel:"noopener noreferrer"},h={href:"https://openhome.alipay.com/develop/manage",target:"_blank",rel:"noopener noreferrer"},y=c(`<p>需要获取：Appld、支付宝网关地址、应用私钥、支付宝公钥</p><h3 id="内网穿透" tabindex="-1"><a class="header-anchor" href="#内网穿透" aria-hidden="true">#</a> 内网穿透</h3><p>打开内网穿透工具，可以使用 nat-app</p><p>原因：因为要把本地的服务暴露到公网，让支付宝可以调用我们的接口给我们传递数据</p><h3 id="导入依赖" tabindex="-1"><a class="header-anchor" href="#导入依赖" aria-hidden="true">#</a> 导入依赖</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>  &lt;dependency&gt;
            &lt;groupId&gt;com.alipay.sdk&lt;/groupId&gt;
            &lt;artifactId&gt;alipay-sdk-java&lt;/artifactId&gt;
            &lt;version&gt;4.35.79.ALL&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="paycontroller-业务代码" tabindex="-1"><a class="header-anchor" href="#paycontroller-业务代码" aria-hidden="true">#</a> PayController(业务代码)</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/pay&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Api</span><span class="token punctuation">(</span>tags <span class="token operator">=</span> <span class="token string">&quot;支付相关&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PayController</span> <span class="token punctuation">{</span>
    <span class="token comment">// appId</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">APP_ID</span> <span class="token operator">=</span> <span class="token string">&quot;9021000134660166&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// 应用私钥(根据网站显示的填入)</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">APP_PRIVATE_KEY</span> <span class="token operator">=</span> <span class="token string">&quot;MIIEvgIBADANBgkqhqqqqqJyJbcq3Cxsp4gcQr&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">CHARSET</span> <span class="token operator">=</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// 支付宝公钥</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">ALIPAY_PUBLIC_KEY</span> <span class="token operator">=</span> <span class="token string">&quot;MIIBIjANBgkqhkiG9w0qqqqqqBAQEFAAOCAQ8AMIIBDAQAB&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//这是沙箱接口路径,正式路径为https://openapi.alipay.com/gateway.do</span>
    <span class="token comment">//private final String GATEWAY_URL = &quot;https://openapi.alipaydev.com/gateway.do&quot;;</span>
    <span class="token comment">//支付宝网关地址(沙箱地址)</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">GATEWAY_URL</span> <span class="token operator">=</span><span class="token string">&quot;https://openapi-sandbox.dl.alipaydev.com/gateway.do&quot;</span><span class="token punctuation">;</span>
    
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">FORMAT</span> <span class="token operator">=</span> <span class="token string">&quot;JSON&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//签名方式</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">SIGN_TYPE</span> <span class="token operator">=</span> <span class="token string">&quot;RSA2&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//支付宝异步通知路径,付款完毕后会异步调用本项目的方法,必须为公网地址（此处使用内网穿透的地址）</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">NOTIFY_URL</span> <span class="token operator">=</span> <span class="token string">&quot;http://x95iy4.natappfree.cc/pay/returnUrl&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//支付宝同步通知路径,也就是当付款完毕后跳转本项目的页面,可以不是公网地址(可以跳转到网站页面)</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">RETURN_URL</span> <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:5173/#/index&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;alipay&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;支付宝支付&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">alipay</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> orderId<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> httpResponse<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;支付宝支付&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//实例化客户端,填入所需参数</span>
        <span class="token class-name">AlipayClient</span> alipayClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultAlipayClient</span><span class="token punctuation">(</span><span class="token constant">GATEWAY_URL</span><span class="token punctuation">,</span> <span class="token constant">APP_ID</span><span class="token punctuation">,</span> <span class="token constant">APP_PRIVATE_KEY</span><span class="token punctuation">,</span> <span class="token constant">FORMAT</span><span class="token punctuation">,</span> <span class="token constant">CHARSET</span><span class="token punctuation">,</span> <span class="token constant">ALIPAY_PUBLIC_KEY</span><span class="token punctuation">,</span> <span class="token constant">SIGN_TYPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">AlipayTradePagePayRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AlipayTradePagePayRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//在公共参数中设置回跳和通知地址</span>
        request<span class="token punctuation">.</span><span class="token function">setReturnUrl</span><span class="token punctuation">(</span><span class="token constant">RETURN_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">setNotifyUrl</span><span class="token punctuation">(</span><span class="token constant">NOTIFY_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//根据订单编号,查询订单相关信息</span>
<span class="token comment">//        Order order = IPayService.selectById(orderId);</span>
        <span class="token comment">//商户订单号，商户网站订单系统中唯一订单号，必填</span>
        <span class="token class-name">String</span> out_trade_no <span class="token operator">=</span> orderId<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//付款金额，必填</span>
        <span class="token class-name">String</span> total_amount <span class="token operator">=</span> <span class="token string">&quot;0.01&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//订单名称，必填</span>
        <span class="token class-name">String</span> subject <span class="token operator">=</span> <span class="token string">&quot;订单测试&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//商品描述，可空</span>
        <span class="token class-name">String</span> body <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">setBizContent</span><span class="token punctuation">(</span><span class="token string">&quot;{\\&quot;out_trade_no\\&quot;:\\&quot;&quot;</span> <span class="token operator">+</span> out_trade_no <span class="token operator">+</span> <span class="token string">&quot;\\&quot;,&quot;</span>
                <span class="token operator">+</span> <span class="token string">&quot;\\&quot;total_amount\\&quot;:\\&quot;&quot;</span> <span class="token operator">+</span> total_amount <span class="token operator">+</span> <span class="token string">&quot;\\&quot;,&quot;</span>
                <span class="token operator">+</span> <span class="token string">&quot;\\&quot;subject\\&quot;:\\&quot;&quot;</span> <span class="token operator">+</span> subject <span class="token operator">+</span> <span class="token string">&quot;\\&quot;,&quot;</span>
                <span class="token operator">+</span> <span class="token string">&quot;\\&quot;body\\&quot;:\\&quot;&quot;</span> <span class="token operator">+</span> body <span class="token operator">+</span> <span class="token string">&quot;\\&quot;,&quot;</span>
                <span class="token operator">+</span> <span class="token string">&quot;\\&quot;product_code\\&quot;:\\&quot;FAST_INSTANT_TRADE_PAY\\&quot;}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> form <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            form <span class="token operator">=</span> alipayClient<span class="token punctuation">.</span><span class="token function">pageExecute</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用SDK生成表单</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">AlipayApiException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        httpResponse<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;text/html;charset=&quot;</span> <span class="token operator">+</span> <span class="token constant">CHARSET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        httpResponse<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 直接将完整的表单html输出到页面</span>
        httpResponse<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        httpResponse<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/returnUrl&quot;</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token class-name">RequestMethod</span><span class="token punctuation">.</span><span class="token constant">POST</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">returnUrl</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">AlipayApiException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;============同步回调===========(post方法，get方法可能报错)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取支付宝GET过来反馈信息</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> requestParams <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> iter <span class="token operator">=</span> requestParams<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> iter<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> requestParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> valueStr <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                valueStr <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> values<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> valueStr <span class="token operator">+</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">:</span> valueStr <span class="token operator">+</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 乱码解决，这段代码在出现乱码时使用</span>
            valueStr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>valueStr<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            params<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> valueStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//查看参数都有哪些</span>
        <span class="token keyword">boolean</span> signVerified <span class="token operator">=</span> <span class="token class-name">AlipaySignature</span><span class="token punctuation">.</span><span class="token function">rsaCheckV1</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token constant">ALIPAY_PUBLIC_KEY</span><span class="token punctuation">,</span> <span class="token constant">CHARSET</span><span class="token punctuation">,</span> <span class="token constant">SIGN_TYPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用SDK验证签名</span>
<span class="token comment">//验证签名通过</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>signVerified<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 商户订单号</span>
            <span class="token class-name">String</span> out_trade_no <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;out_trade_no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;ISO-8859-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 支付宝交易号</span>
            <span class="token class-name">String</span> trade_no <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;trade_no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;ISO-8859-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 付款金额</span>
            <span class="token class-name">String</span> total_amount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;total_amount&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;ISO-8859-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;商户订单号=&quot;</span><span class="token operator">+</span>out_trade_no<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;支付宝交易号=&quot;</span><span class="token operator">+</span>trade_no<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;付款金额=&quot;</span><span class="token operator">+</span>total_amount<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//支付成功，修复支付状态</span>
            <span class="token comment">// payService.updateById(Integer.valueOf(out_trade_no));</span>
            <span class="token keyword">return</span> <span class="token string">&quot;ok&quot;</span><span class="token punctuation">;</span><span class="token comment">//跳转付款成功</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">&quot;no&quot;</span><span class="token punctuation">;</span><span class="token comment">//跳转付款失败</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="前端调用" tabindex="-1"><a class="header-anchor" href="#前端调用" aria-hidden="true">#</a> 前端调用</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 前端点击支付后，调用pay方法，打开支付页面（ orderId是订单号 ）</span>
<span class="token keyword">const</span> <span class="token function-variable function">pay</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token comment">// 支付宝支付 (这个路径对应后台接口路径)</span>
  window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8084/pay/alipay?orderId=1522&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="流程" tabindex="-1"><a class="header-anchor" href="#流程" aria-hidden="true">#</a> 流程</h3><p>1 用户点击支付，打开支付页面 <code>window.open(&quot;http://localhost:8084/pay/alipay?orderId=1522&quot;)</code> ，这个支付页面是后端代码生成的（需要传递订单号这个参数）。</p><p>2 用户输入账号，密码，支付密码完成支付。</p><p>3 支付成功后会调用后台的回调方法 /pay/returnUrl ，（可以返回支付的相关信息）。</p><p>4 付款完毕后跳转本项目的任意页面 RETURN_URL （可以自行设置跳转到的页面）</p><h2 id="聚合支付" tabindex="-1"><a class="header-anchor" href="#聚合支付" aria-hidden="true">#</a> 聚合支付</h2>`,16),f={href:"https://docs.jeequan.com/docs/jeepay/index",target:"_blank",rel:"noopener noreferrer"};function _(S,w){const a=l("ExternalLinkIcon");return e(),o("div",null,[u,r,n("p",null,[n("a",k,[s("产品中心 - 微信支付商户平台 (qq.com)"),t(a)])]),n("p",null,[n("a",d,[s("微信支付接入指引 - 微信支付商户平台 (qq.com)"),t(a)])]),m,v,n("p",null,[s("参考："),n("a",q,[s("支付宝沙箱支付——傻瓜教程_支付宝沙箱支付教程-CSDN博客"),t(a)])]),g,n("p",null,[s("沙箱环境："),n("a",b,[s("沙箱环境 - 支付宝文档中心 (alipay.com)"),t(a)])]),n("p",null,[n("a",h,[s("开放平台 (alipay.com)"),t(a)]),s(" 支付宝扫码登录-》点击沙箱=》查看沙箱应用")]),y,n("p",null,[n("a",f,[s("Jeepay - 计全文档 (jeequan.com)"),t(a)])])])}const x=p(i,[["render",_],["__file","zhifu.html.vue"]]);export{x as default};
